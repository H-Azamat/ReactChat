(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[1],{14:function(e,t,n){"use strict";var s=n.p+"static/media/loading.ad992768.gif",r=n(2);t.a=function(){return Object(r.jsx)("div",{className:"loading",children:Object(r.jsx)("img",{src:s,alt:"loading...",className:"loading-gif"})})}},16:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return j}));var s=n(36),r=n(15),a=n(38),c="SET_CURRENT_USER",u="UPDATE_MESSAGES",i="SET_USERS",o={messages:[],users:[],currentUser:{},isInitial:!1},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{type:c,currentUser:{uid:e,username:t,userImg:n,description:s,social:r},isInitial:a}},l=function(e){return{type:u,messages:e}},j=function(e){return{type:i,users:e}},b=Object(a.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:return Object(r.a)(Object(r.a)({},e),{},{currentUser:Object(r.a)({},t.currentUser),isInitial:t.isInitial});case u:return Object(r.a)(Object(r.a)({},e),{},{messages:Object(s.a)(t.messages)});case i:return Object(r.a)(Object(r.a)({},e),{},{users:Object(s.a)(t.users)});default:return e}}));window.store=b,t.a=b},24:function(e,t,n){"use strict";var s=n(33);n(55);s.a.initializeApp({apiKey:"AIzaSyDz6pSdf4LCf1YQn5x76haqeGwwPDTvP_U",authDomain:"reactchat-b8de4.firebaseapp.com",projectId:"reactchat-b8de4",storageBucket:"reactchat-b8de4.appspot.com",messagingSenderId:"318740535879",appId:"1:318740535879:web:7c66edf44f5ebf3e09ef62"}),t.a=s.a},37:function(e,t,n){"use strict";t.a=n.p+"static/media/userImg.741810bd.svg"},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var s=n(29),r=n(1),a=n(18),c=n(14),u=n(20),i=n(37),o=n(2),d=function(e){return Object(o.jsxs)("div",{className:"chat-message__block ".concat(e.currentUserId===e.userId?"my-message__block":""),children:[Object(o.jsx)("img",{src:e.avatar||i.a,alt:"avatar",className:"message-avatar"}),Object(o.jsxs)("div",{className:"chat-message ".concat(e.currentUserId===e.userId?"my-message":""),children:[e.currentUserId!==e.userId&&Object(o.jsx)(u.b,{to:"/profile/"+e.userId,className:"chat-message-username",children:e.username}),Object(o.jsx)("p",{className:"chat-message-text",children:e.message}),Object(o.jsx)("span",{className:"chat-message-date",children:e.date})]})]})},l=n(16),j=n(24).a.firestore();t.b=Object(a.b)((function(e){return{messages:e.messages,users:e.users,id:e.currentUser.uid}}),{updateMessages:l.d})((function(e){var t=Object(r.useState)(!0),n=Object(s.a)(t,2),a=n[0],u=n[1],i=Object(r.useState)(15),l=Object(s.a)(i,2),b=l[0],f=l[1],h=function(t){return e.users.filter((function(e){return e.userId===t}))[0]};Object(r.useEffect)((function(){var t=j.collection("messages").orderBy("key","asc").limitToLast(b).onSnapshot((function(t){var n=[];t.forEach((function(e){return n.push({userId:e.data().id,message:e.data().message,avatar:e.data().avatar,username:e.data().username,date:e.data().date,key:e.data().key})})),e.updateMessages(n),u(!1)}));return function(){t()}}),[b]);var m=Object(r.useRef)(null);m.current&&15===b&&setTimeout((function(){m.current.scrollTop=m.current.scrollHeight}),1);return Object(o.jsx)("div",{onScroll:function(){0===m.current.scrollTop&&f(b+15)},className:"chat-messages",ref:m,children:a?Object(o.jsx)(c.a,{}):Object(o.jsx)("div",{children:e.messages.map((function(t){return Object(o.jsx)(d,{userId:t.userId,avatar:h(t.userId).img,message:t.message,username:h(t.userId).username,currentUserId:e.id,date:t.date},t.key)}))})})}))},51:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n(26),a=n.n(r),c=n(18),u=n(20),i=n(21),o=n.n(i),d=n(30),l=n(6),j=n(16),b=n(24),f=(n(40),n(51),n(14)),h=n(39),m=n(2),O=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(9),n.e(4)]).then(n.bind(null,80))})),p=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,79))})),g=Object(s.lazy)((function(){return n.e(6).then(n.bind(null,77))})),x=Object(s.lazy)((function(){return n.e(7).then(n.bind(null,78))})),v=Object(s.lazy)((function(){return n.e(8).then(n.bind(null,81))}));var I=Object(c.b)((function(e){return{isInitial:e.isInitial}}),{setUsers:j.c,setCurrentUser:j.b})((function(e){var t=e.setCurrentUser,n=e.isInitial,r=e.setUsers,a=function(){var e=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.collection("users").onSnapshot((function(e){var n=[];e.forEach((function(e){return n.push({userId:e.data().userId,img:e.data().img,username:e.data().username,description:e.data().description,social:e.data().social})})),r(n),b.a.auth().onAuthStateChanged((function(e){if(!e)return t("","",null,"",{},!0),Object(m.jsx)(l.a,{from:"/",to:"/login"});var s=n.filter((function(t){return t.userId===e.uid}))[0];t(s.userId,s.username,s.img,s.description,s.social,!0)}))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){(function(){var e=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()})),Object(m.jsx)("div",{className:"App",children:n?Object(m.jsx)("div",{children:Object(m.jsxs)(l.d,{children:[Object(m.jsx)(l.b,{exact:!0,path:"/chat",render:function(){return Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(f.a,{}),children:Object(m.jsx)(O,{})})}}),Object(m.jsx)(l.b,{exact:!0,path:"/profile/:userId?",render:function(){return Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(f.a,{}),children:Object(m.jsx)(p,{})})}}),Object(m.jsx)(l.b,{path:"/login",render:function(){return Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(f.a,{}),children:Object(m.jsx)(g,{})})}}),Object(m.jsx)(l.b,{path:"/register",render:function(){return Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(f.a,{}),children:Object(m.jsx)(x,{})})}}),Object(m.jsx)(l.a,{exact:!0,from:"/",to:"/chat"}),Object(m.jsx)(l.b,{path:"*",render:function(){return Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(f.a,{}),children:Object(m.jsx)(v,{})})}})]})}):Object(m.jsx)(f.a,{})})}));a.a.render(Object(m.jsx)(u.a,{children:Object(m.jsx)(c.a,{store:j.a,children:Object(m.jsx)(I,{})})}),document.getElementById("root"))}},[[54,2,3]]]);
//# sourceMappingURL=main.68296207.chunk.js.map