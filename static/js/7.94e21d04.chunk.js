(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[7],{50:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return f}));var n=r(51),a=r.n(n),s=r(52),c=r(32),i=(r(35),c.a.firestore()),u={signIn:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n,s){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,c.a.auth().signInWithEmailAndPassword(r,n).then((function(e){var t=e.user;t&&t.emailVerified?s(!0):alert("\u041d\u0435 \u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d")})).catch((function(e){alert("\u041d\u0435 \u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d")}));case 3:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),register:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n,s,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,c.a.auth().createUserWithEmailAndPassword(r.trim(),n.trim()).then((function(e){var t=e.user;t.updateProfile({displayName:s}),t.sendEmailVerification().then((function(){i(!0)})).catch((function(e){alert(e.message)}))})).catch((function(e){throw alert(e.message),e}));case 3:case"end":return e.stop()}}),e)})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),sendEmail:function(){var e=Object(s.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.a.auth().currentUser,e.next=3,r.sendEmailVerification().then((function(){t(!0)})).catch((function(e){alert(e.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.auth().signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},o={sendMessage:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,i.collection("messages").add({message:t,id:n,date:r,key:new Date});case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},f={updateProfile:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.a.auth().currentUser,e.next=3,s.updateProfile({displayName:r,photoURL:t}).then((function(){n(s.uid,r,t,!0)}));case 3:i.collection("users").doc(s.uid).update({username:r,img:t}).then((function(){n(s.uid,r,t,!0)}));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),getUserProfile:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.collection("users").doc(t).get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},55:function(e,t,r){"use strict";t.a=r.p+"static/media/userImg.c9678b2f.svg"},56:function(e,t,r){"use strict";var n=r(20),a=r.p+"static/media/Logo.812a9abb.svg",s=(r(50),r(55)),c=r(25),i=r(4);t.a=Object(n.b)((function(e){return{username:e.currentUser.username,userImg:e.currentUser.userImg}}))((function(e){var t=e.username,r=e.userImg;return Object(i.jsxs)("div",{className:"header",children:[Object(i.jsx)("img",{src:a,alt:"ReactChat",className:"header-logo"}),Object(i.jsx)("div",{className:"header-info",children:Object(i.jsxs)(c.b,{to:"/profile",className:"header-toProfile",children:[Object(i.jsx)("span",{className:"header-username",children:t}),Object(i.jsx)("img",{src:r||s.a,alt:"imgProfile",className:"header-img"})]})})]})}))},65:function(e,t,r){"use strict";r.r(t);var n=r(51),a=r.n(n),s=r(52),c=r(57),i=r(58),u=r(60),o=r(59),f=r(1),p=r(50),l=r(34),m=r(20),d=r(6),h=r(53),j=r(25),b=r(56),v=r(55),x=r.p+"static/media/close.9f73c1c5.svg",g=r.p+"static/media/check.6e53806f.svg",O=r(4),k=function(e){var t=Object(f.useState)(e.username),r=Object(h.a)(t,2),n=r[0],a=r[1],s=Object(f.useState)(e.img),c=Object(h.a)(s,2),i=c[0],u=c[1],o=Object(f.useState)(null),p=Object(h.a)(o,2),l=p[0],m=p[1];return Object(f.useEffect)((function(){a(e.username),u(e.img)}),[e]),Object(O.jsx)("div",{className:"profile",children:e.isFound?Object(O.jsxs)("div",{children:[Object(O.jsx)(b.a,{}),Object(O.jsxs)("div",{className:"profileInfo",children:[Object(O.jsxs)("div",{className:"profileInfo-actions",children:[Object(O.jsxs)(j.b,{to:"/",children:[" ",Object(O.jsx)("img",{src:x,alt:"close",className:"profileInfo-close"})," "]}),e.isCurrent&&Object(O.jsx)("img",{src:g,alt:"check",className:"profileInfo-check",onClick:function(){return e.updateProfile(l,m,u,i,n)}})]}),e.isCurrent?Object(O.jsx)("input",{className:"profileInfo-username isCurrent",type:"text",value:n,onChange:function(e){a(e.target.value)}}):Object(O.jsx)("input",{className:"profileInfo-username",type:"text",value:n,readOnly:!0}),Object(O.jsx)("div",{className:"profileInfo-photo__block",children:Object(O.jsx)("img",{alt:"userImg",className:"profileInfo-photo",src:i||v.a})}),e.isCurrent&&Object(O.jsxs)("div",{children:[Object(O.jsx)("p",{className:"profileInfo-text",children:"\u0412\u0441\u0442\u0430\u0432\u044c\u0442\u0435 URL \u0441\u0441\u044b\u043b\u043a\u0443 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438:"}),Object(O.jsx)("input",{type:"url",className:"profileInfo-photo__file",value:l||"",onChange:function(e){m(e.target.value)}})]})]})]}):Object(O.jsx)(d.a,{to:"/error"})})},w=r(21),I=r(15),y=r(32),N=(r(35),function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).refreshProfile=Object(s.a)(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.props.match.params.userId)){e.next=8;break}return e.next=4,p.c.getUserProfile(t).then((function(e){return e.data()}));case 4:(r=e.sent).userId&&n.setState({img:r.img,username:r.username,isLoading:!1,isCurrent:!1}),e.next=9;break;case 8:n.setState({img:n.props.img,username:n.props.username,isLoading:!1,isCurrent:!0});case 9:case"end":return e.stop()}}),e)}))),n.updateProfile=function(){var e=Object(s.a)(a.a.mark((function e(t,r,s,c,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&s(t),e.next=3,p.c.updateProfile(t||c,i,n.props.setCurrentUser);case 3:r("");case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),n.state={isFound:!0,img:n.props.img,username:n.props.username,isLoading:!0,isRedirect:!1,isCurrent:!1},n}return Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=y.a.auth().currentUser)||!t.emailVerified){e.next=7;break}return this.setState({isRedirect:!1}),e.next=5,this.refreshProfile();case 5:e.next=8;break;case 7:this.setState({isRedirect:!0});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.match.params.userId===t.match.params.userId&&this.state.username===r.username){e.next=3;break}return e.next=3,this.refreshProfile();case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.isRedirect?Object(O.jsx)(d.a,{to:"/login"}):Object(O.jsx)("div",{children:this.state.isLoading?Object(O.jsx)(I.a,{}):Object(O.jsx)(k,{img:this.state.img,username:this.state.username,updateProfile:this.updateProfile,isFound:this.state.isFound,isCurrent:this.state.isCurrent})})}}]),r}(f.Component));t.default=Object(l.a)(Object(m.b)((function(e){return{username:e.currentUser.username,img:e.currentUser.userImg}}),{setCurrentUser:w.b}),d.g)(N)}}]);
//# sourceMappingURL=7.94e21d04.chunk.js.map