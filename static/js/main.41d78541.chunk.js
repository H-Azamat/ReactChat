(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[1],{16:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(34),a=n(18),c=n(37),s="SET_CURRENT_USER",i="UPDATE_MESSAGES",u="SET_USERS",o={messages:[],users:[],currentUser:{},isInitial:!1},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{type:s,currentUser:{uid:e,username:t,userImg:n,description:r,social:a},isInitial:c}},l=function(e){return{type:i,messages:e}},d=function(e){return{type:u,users:e}},p=Object(c.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return Object(a.a)(Object(a.a)({},e),{},{currentUser:Object(a.a)({},t.currentUser),isInitial:t.isInitial});case i:return Object(a.a)(Object(a.a)({},e),{},{messages:Object(r.a)(t.messages)});case u:return Object(a.a)(Object(a.a)({},e),{},{users:Object(r.a)(t.users)});default:return e}}));window.store=p,t.a=p},17:function(e,t,n){"use strict";var r=n(31);n(53);r.a.initializeApp({apiKey:"AIzaSyDz6pSdf4LCf1YQn5x76haqeGwwPDTvP_U",authDomain:"reactchat-b8de4.firebaseapp.com",projectId:"reactchat-b8de4",storageBucket:"reactchat-b8de4.appspot.com",messagingSenderId:"318740535879",appId:"1:318740535879:web:7c66edf44f5ebf3e09ef62"}),t.a=r.a},19:function(e,t,n){"use strict";var r=n.p+"static/media/loading.ad992768.gif",a=n(4);t.a=function(){return Object(a.jsx)("div",{className:"loading",children:Object(a.jsx)("img",{src:r,alt:"loading...",className:"loading-gif"})})}},35:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n(6),a=n.n(r),c=n(11),s=n(17),i=(n(38),n(16)),u=n(7),o=n(4),f=s.a.firestore(),l={signIn:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r,c){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,s.a.auth().signInWithEmailAndPassword(n,r).then((function(e){var t=e.user;t&&t.emailVerified?c(!0):alert("\u041d\u0435 \u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d")})).catch((function(e){alert("\u041d\u0435 \u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d")}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),register:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r,c,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,s.a.auth().createUserWithEmailAndPassword(n.trim(),r.trim()).then((function(e){var t=e.user;t.updateProfile({displayName:c}),f.collection("users").doc(t.uid).set({username:c,img:null,description:"",social:{github:null,instagram:null,telegram:null,vk:null,youtube:null},userId:t.uid}),t.sendEmailVerification().then((function(){i(!0)})).catch((function(e){alert(e.message)}))})).catch((function(e){throw alert(e.message),e}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),sendEmail:function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.a.auth().currentUser,e.next=3,n.sendEmailVerification().then((function(){t(!0)})).catch((function(e){alert(e.message)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.auth().signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},d={sendMessage:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,f.collection("messages").add({message:t,id:r,date:n,type:"text",key:new Date});case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),sendMessageWithImg:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.src&&t.size<=5e6)||"image/png"!==t.type&&"image/jpeg"!==t.type){e.next=6;break}return e.next=3,f.collection("messages").add({img:t.src,id:r,date:n,type:"img",key:new Date});case 3:return e.abrupt("return","\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 :)");case 6:if(!(t.size>5e5)){e.next=10;break}return e.abrupt("return","\u041c\u044b \u043d\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u043c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u0431\u043e\u043b\u0435\u0435 5\u043c\u0431 :(");case 10:if("image/png"===t.type&&"image/jpeg"===t.type){e.next=12;break}return e.abrupt("return","\u041c\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u043c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c .png/jpg :)");case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},p={updateProfile:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r,c){var u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=s.a.auth().currentUser,e.next=3,f.collection("users").doc(u.uid).update({username:n,img:t,description:r,social:c}).then((function(){Object(i.b)(u.uid,n,t,r,!0)}));case 3:return e.next=5,u.updateProfile({displayName:n,photoURL:t,description:r}).then((function(){Object(i.b)(u.uid,n,t,r,!0)}));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),getUserProfile:function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").doc(t).get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getUsers:function(){var e=Object(c.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.collection("users").onSnapshot((function(e){var r=[];e.forEach((function(e){return r.push({userId:e.data().userId,img:e.data().img,username:e.data().username,description:e.data().description,social:e.data().social})})),n(r),s.a.auth().onAuthStateChanged((function(e){if(!e)return t("","",null,"",{},!0),Object(o.jsx)(u.a,{from:"/",to:"/login"});var n=r.filter((function(t){return t.userId===e.uid}))[0];t(n.userId,n.username,n.img,n.description,n.social,!0)}))}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},47:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(27),c=n.n(a),s=n(25),i=n(24),u=n(6),o=n.n(u),f=n(11),l=n(7),d=n(16),p=(n(47),n(19)),b=n(35),j=n(4),h=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(9),n.e(4)]).then(n.bind(null,79))})),m=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,78))})),g=Object(r.lazy)((function(){return n.e(6).then(n.bind(null,76))})),x=Object(r.lazy)((function(){return n.e(7).then(n.bind(null,77))})),O=Object(r.lazy)((function(){return n.e(8).then(n.bind(null,80))}));var v=Object(s.b)((function(e){return{isInitial:e.isInitial}}),{setUsers:d.c,setCurrentUser:d.b})((function(e){var t=e.setCurrentUser,n=e.isInitial,a=e.setUsers,c=function(){var e=Object(f.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.c.getUsers(t,a);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){(function(){var e=Object(f.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()})),Object(j.jsx)("div",{className:"App",children:n?Object(j.jsx)("div",{children:Object(j.jsxs)(l.d,{children:[Object(j.jsx)(l.b,{exact:!0,path:"/chat",render:function(){return Object(j.jsx)(r.Suspense,{fallback:Object(j.jsx)(p.a,{}),children:Object(j.jsx)(h,{})})}}),Object(j.jsx)(l.b,{exact:!0,path:"/profile/:userId?",render:function(){return Object(j.jsx)(r.Suspense,{fallback:Object(j.jsx)(p.a,{}),children:Object(j.jsx)(m,{})})}}),Object(j.jsx)(l.b,{path:"/login",render:function(){return Object(j.jsx)(r.Suspense,{fallback:Object(j.jsx)(p.a,{}),children:Object(j.jsx)(g,{})})}}),Object(j.jsx)(l.b,{path:"/register",render:function(){return Object(j.jsx)(r.Suspense,{fallback:Object(j.jsx)(p.a,{}),children:Object(j.jsx)(x,{})})}}),Object(j.jsx)(l.a,{exact:!0,from:"/",to:"/chat"}),Object(j.jsx)(l.b,{path:"*",render:function(){return Object(j.jsx)(r.Suspense,{fallback:Object(j.jsx)(p.a,{}),children:Object(j.jsx)(O,{})})}})]})}):Object(j.jsx)(p.a,{})})}));c.a.render(Object(j.jsx)(i.a,{children:Object(j.jsx)(s.a,{store:d.a,children:Object(j.jsx)(v,{})})}),document.getElementById("root"))}},[[52,2,3]]]);
//# sourceMappingURL=main.41d78541.chunk.js.map